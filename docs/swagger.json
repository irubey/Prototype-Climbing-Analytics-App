{"openapi":"3.1.0","info":{"title":"Send Sage","description":"Send Sage API - FastAPI Implementation","version":"1.0.0"},"paths":{"/api/v1/auth/register":{"post":{"tags":["authentication"],"summary":"Register","description":"Register a new user.","operationId":"register_api_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/token":{"post":{"tags":["authentication"],"summary":"Login For Access Token","description":"OAuth2 compatible token login, get an access token for future requests.\nImplements rate limiting and refresh token rotation.\nAlso handles account reactivation for deactivated accounts.","operationId":"login_for_access_token_api_v1_auth_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_for_access_token_api_v1_auth_token_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/refresh-token":{"post":{"tags":["authentication"],"summary":"Refresh Token","description":"Refresh access token using a valid refresh token from Authorization header or HttpOnly cookie.\nImplements refresh token rotation with single-use tokens.","operationId":"refresh_token_api_v1_auth_refresh_token_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Token"}}}}}}},"/api/v1/auth/revoke":{"post":{"tags":["authentication"],"summary":"Revoke Token","description":"Revoke an access or refresh token.\nThe token will be added to the revoked tokens list.","operationId":"revoke_token_api_v1_auth_revoke_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenRevokeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/introspect":{"post":{"tags":["authentication"],"summary":"Introspect Token","description":"OAuth2 token introspection endpoint.\nReturns information about the token's validity and claims.","operationId":"introspect_token_api_v1_auth_introspect_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenIntrospectRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenIntrospectResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/logout":{"post":{"tags":["authentication"],"summary":"Logout","description":"Logout the current user. Revokes access and refresh tokens, clears cookies.","operationId":"logout_api_v1_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/auth/password-reset":{"post":{"tags":["authentication"],"summary":"Request Password Reset","description":"Request a password reset token.\n\n- Generates reset token if user exists\n- Sends reset email in background\n- Returns 202 regardless of email existence for security","operationId":"request_password_reset_api_v1_auth_password_reset_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordReset"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Request Password Reset Api V1 Auth Password Reset Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/reset-password":{"post":{"tags":["authentication"],"summary":"Reset Password","description":"Reset password using reset token.\n\n- Validates reset token\n- Updates password if token valid\n- Invalidates all existing sessions","operationId":"reset_password_api_v1_auth_reset_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Reset Password Api V1 Auth Reset Password Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/test_test":{"post":{"tags":["authentication"],"summary":"Test Test","description":"Test endpoint to check test client.","operationId":"test_test_api_v1_auth_test_test_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/chat/stream":{"get":{"tags":["chat"],"summary":"Stream Events","description":"Stream chat events for the current user using Server-Sent Events.","operationId":"stream_events_api_v1_chat_stream_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/chat/basic":{"post":{"tags":["chat"],"summary":"Basic Chat Endpoint","description":"Basic tier chat endpoint with quota enforcement.","operationId":"basic_chat_endpoint_api_v1_chat_basic_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"prompt","in":"query","required":true,"schema":{"type":"string","title":"Prompt"}},{"name":"conversation_id","in":"query","required":true,"schema":{"type":"string","title":"Conversation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/premium":{"post":{"tags":["chat"],"summary":"Premium Chat Endpoint","description":"Premium tier chat endpoint with file upload support.","operationId":"premium_chat_endpoint_api_v1_chat_premium_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"prompt","in":"query","required":true,"schema":{"type":"string","title":"Prompt"}},{"name":"conversation_id","in":"query","required":true,"schema":{"type":"string","title":"Conversation Id"}}],"requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_premium_chat_endpoint_api_v1_chat_premium_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/history/{conversation_id}":{"get":{"tags":["chat"],"summary":"Get Conversation History","description":"Retrieve conversation history for a specific conversation.","operationId":"get_conversation_history_api_v1_chat_history__conversation_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"conversation_id","in":"path","required":true,"schema":{"type":"string","title":"Conversation Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/context/{user_id}":{"get":{"tags":["context"],"summary":"Get Context","description":"Retrieve context for a user with optional query parameters.\n\nArgs:\n    user_id: Target user ID\n    query_params: Optional query parameters for context customization\n    db: Async database session\n    current_user: Authenticated user from dependency\n    \nReturns:\n    Dict containing context data\n    \nRaises:\n    ResourceNotFound: If user context doesn't exist\n    ValidationError: If query parameters are invalid","operationId":"get_context_api_v1_context__user_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"query","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Query"}},{"name":"force_refresh","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Force Refresh"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContextResponse"}}}},"401":{"description":"Authentication failed","content":{"application/json":{"example":{"error":{"status_code":401,"message":"Could not validate credentials","type":"AuthenticationError"}}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"error":{"status_code":500,"message":"An unexpected error occurred","type":"InternalServerError"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["context"],"summary":"Update Context","description":"Update specific sections of a user's context.\n\nArgs:\n    user_id: Target user ID\n    payload: Context update data\n    db: Async database session\n    current_user: Authenticated user from dependency\n    \nReturns:\n    Dict containing updated context\n    \nRaises:\n    ResourceNotFound: If user context doesn't exist\n    ValidationError: If update payload is invalid","operationId":"update_context_api_v1_context__user_id__patch","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContextUpdatePayload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ContextResponse"}}}},"401":{"description":"Authentication failed","content":{"application/json":{"example":{"error":{"status_code":401,"message":"Could not validate credentials","type":"AuthenticationError"}}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"error":{"status_code":500,"message":"An unexpected error occurred","type":"InternalServerError"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/context/{user_id}/refresh":{"post":{"tags":["context"],"summary":"Refresh Context","description":"Initiate asynchronous context refresh.\n\nArgs:\n    user_id: Target user ID\n    background_tasks: FastAPI background tasks handler\n    db: Async database session\n    current_user: Authenticated user from dependency\n    \nReturns:\n    Dict containing status message","operationId":"refresh_context_api_v1_context__user_id__refresh_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"},"title":"Response Refresh Context Api V1 Context  User Id  Refresh Post"}}}},"401":{"description":"Authentication failed","content":{"application/json":{"example":{"error":{"status_code":401,"message":"Could not validate credentials","type":"AuthenticationError"}}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"error":{"status_code":500,"message":"An unexpected error occurred","type":"InternalServerError"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/context/bulk-refresh":{"post":{"tags":["context"],"summary":"Bulk Refresh Contexts","description":"Initiate bulk context refresh for multiple users.\n\nArgs:\n    background_tasks: FastAPI background tasks handler\n    user_ids: Optional list of user IDs to refresh\n    db: Async database session\n    current_user: Authenticated user from dependency\n    \nReturns:\n    Dict containing status message","operationId":"bulk_refresh_contexts_api_v1_context_bulk_refresh_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"user_ids","in":"query","required":false,"schema":{"anyOf":[{"type":"array","items":{"type":"string"}},{"type":"null"}],"title":"User Ids"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"},"title":"Response Bulk Refresh Contexts Api V1 Context Bulk Refresh Post"}}}},"401":{"description":"Authentication failed","content":{"application/json":{"example":{"error":{"status_code":401,"message":"Could not validate credentials","type":"AuthenticationError"}}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"error":{"status_code":500,"message":"An unexpected error occurred","type":"InternalServerError"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/data/ticks/batch":{"post":{"tags":["data"],"summary":"Create Ticks Batch","description":"Create multiple ticks in batch.","operationId":"create_ticks_batch_api_v1_data_ticks_batch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BatchTickCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"type":"integer"},"type":"array","title":"Response Create Ticks Batch Api V1 Data Ticks Batch Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/data/ticks/{tick_id}":{"delete":{"tags":["data"],"summary":"Delete Tick","description":"Delete a specific tick and its associated performance pyramid data.","operationId":"delete_tick_api_v1_data_ticks__tick_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"tick_id","in":"path","required":true,"schema":{"type":"integer","title":"Tick Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/data/pyramid":{"post":{"tags":["data"],"summary":"Update Pyramid","description":"Update performance pyramid data with manual input.","operationId":"update_pyramid_api_v1_data_pyramid_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PyramidInput"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PyramidInput"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/data/refresh":{"post":{"tags":["data"],"summary":"Refresh Data","description":"Refresh user's logbook data.","operationId":"refresh_data_api_v1_data_refresh_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshStatus"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/health/":{"get":{"tags":["health"],"summary":"Health Check","description":"Basic health check endpoint.","operationId":"health_check_api_v1_health__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Check Api V1 Health  Get"}}}}}}},"/api/v1/health/db":{"get":{"tags":["health"],"summary":"Db Health Check","description":"Check database connection health.","operationId":"db_health_check_api_v1_health_db_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Db Health Check Api V1 Health Db Get"}}}}}}},"/api/v1/logbook/connect":{"post":{"tags":["logbook"],"summary":"Connect Logbook","description":"Initiate asynchronous logbook ingestion and processing.\n\nArgs:\n    payload: Validated connection payload containing source and credentials\n    background_tasks: FastAPI background tasks handler\n    db: Async database session\n    current_user: Authenticated user from dependency\n    \nReturns:\n    Dict containing status message\n    \nRaises:\n    LogbookConnectionError: If connection to logbook service fails","operationId":"connect_logbook_api_v1_logbook_connect_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogbookConnectPayload"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Connect Logbook Api V1 Logbook Connect Post"}}}},"401":{"description":"Authentication failed","content":{"application/json":{"example":{"error":{"status_code":401,"message":"Could not validate credentials","type":"AuthenticationError"}}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"error":{"status_code":500,"message":"An unexpected error occurred","type":"InternalServerError"}}}}},"503":{"description":"Logbook service unavailable","content":{"application/json":{"example":{"error":{"status_code":503,"message":"Could not connect to logbook service","type":"LogbookConnectionError"}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/payment/pricing":{"get":{"tags":["payment"],"summary":"Get Pricing Info","description":"Get pricing information for all tiers.","operationId":"get_pricing_info_api_v1_payment_pricing_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"$ref":"#/components/schemas/PricingInfo"},"type":"object","title":"Response Get Pricing Info Api V1 Payment Pricing Get"}}}}}}},"/api/v1/payment/create-checkout-session":{"post":{"tags":["payment"],"summary":"Create Checkout Session","description":"Create Stripe checkout session for subscription.","operationId":"create_checkout_session_api_v1_payment_create_checkout_session_post","security":[{"OAuth2PasswordBearer":["user"]}],"parameters":[{"name":"tier","in":"query","required":true,"schema":{"$ref":"#/components/schemas/UserTier"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StripeCheckoutSession"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/payment/webhook":{"post":{"tags":["payment"],"summary":"Stripe Webhook","description":"Handle Stripe webhook events.","operationId":"stripe_webhook_api_v1_payment_webhook_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Stripe Webhook Api V1 Payment Webhook Post"}}}}}}},"/api/v1/users/me":{"get":{"tags":["users","users"],"summary":"Get Current User Profile","description":"Get current user's profile information.\n\n- Returns user profile data from cache if available\n- Includes climber summary if available\n- Requires valid access token\n- Caches result for 5 minutes","operationId":"get_current_user_profile_api_v1_users_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]},"delete":{"tags":["users","users"],"summary":"Delete User Account","description":"Delete current user's account.\n\n- Removes user data\n- Cancels active subscriptions\n- Deletes associated records\n- Requires valid access token","operationId":"delete_user_account_api_v1_users_me_delete","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Delete User Account Api V1 Users Me Delete"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]},"patch":{"tags":["users","users"],"summary":"Update User Profile","description":"Update current user's profile.\n\n- Updates basic profile information\n- Handles Mountain Project URL changes\n- Handles 8a.nu URL changes\n- Triggers background data sync if URLs change\n- Invalidates profile cache\n- Requires valid access token","operationId":"update_user_profile_api_v1_users_me_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfileUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/users/{user_id}":{"get":{"tags":["users","users"],"summary":"Get User Profile","description":"Get user profile by ID (admin only).\n\n- Returns user profile data\n- Requires admin privileges\n- Requires valid access token with admin scope","operationId":"get_user_profile_api_v1_users__user_id__get","security":[{"OAuth2PasswordBearer":["admin"]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfile"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/me/change-password":{"post":{"tags":["users","users"],"summary":"Change Password","description":"Change user's password securely.\n\n- Validates old password\n- Checks password complexity\n- Revokes existing tokens\n- Sends email notification\n- Rate limited to 5 attempts per minute","operationId":"change_password_api_v1_users_me_change_password_post","security":[{"OAuth2PasswordBearer":["user"]}],"parameters":[{"name":"old_password","in":"query","required":true,"schema":{"type":"string","title":"Old Password"}},{"name":"new_password","in":"query","required":true,"schema":{"type":"string","title":"New Password"}},{"name":"confirmation","in":"query","required":true,"schema":{"type":"string","title":"Confirmation"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Change Password Api V1 Users Me Change Password Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/users/me/message-count":{"get":{"tags":["users","users"],"summary":"Get Message Count","description":"Get user's message count and limits.\n\n- Returns daily message count\n- Shows tier-specific limits\n- Calculates remaining messages\n- Uses rolling 24-hour window","operationId":"get_message_count_api_v1_users_me_message_count_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Message Count Api V1 Users Me Message Count Get"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/users/me/deactivate":{"post":{"tags":["users","users"],"summary":"Deactivate Account","description":"Deactivate user's account (soft delete).\n\n- Sets account as inactive\n- Cancels active subscriptions\n- Revokes active tokens\n- Invalidates profile cache\n- Preserves data for reactivation via login","operationId":"deactivate_account_api_v1_users_me_deactivate_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Deactivate Account Api V1 Users Me Deactivate Post"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/users/me/subscription":{"get":{"tags":["users","users"],"summary":"Get Subscription","description":"Retrieve subscription details with Stripe sync.\n\n- Returns current tier and status\n- Syncs with Stripe for latest data\n- Shows renewal and billing dates","operationId":"get_subscription_api_v1_users_me_subscription_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Subscription Api V1 Users Me Subscription Get"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/users/me/subscribe":{"post":{"tags":["users","users"],"summary":"Create Subscription","description":"Initiate a new subscription.\n\n- Creates Stripe checkout session\n- Updates user tier immediately (pending webhook confirmation)\n- Handles existing subscription\n- Webhook will finalize or revert tier change","operationId":"create_subscription_api_v1_users_me_subscribe_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Create Subscription Api V1 Users Me Subscribe Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/users/me/cancel-subscription":{"post":{"tags":["users","users"],"summary":"Cancel Subscription","description":"Cancel active subscription.\n\n- Cancels Stripe subscription\n- Updates user tier to free\n- Sets payment status to cancelled","operationId":"cancel_subscription_api_v1_users_me_cancel_subscription_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Cancel Subscription Api V1 Users Me Cancel Subscription Post"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/visualization/dashboard-base-metrics":{"get":{"tags":["visualization"],"summary":"Get Dashboard Data","description":"Get user's climbing dashboard overview.","operationId":"get_dashboard_data_api_v1_visualization_dashboard_base_metrics_get","security":[{"OAuth2PasswordBearer":["user"]}],"parameters":[{"name":"time_range","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Time Range"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardBaseMetrics"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/visualization/dashboard-performance-metrics":{"get":{"tags":["visualization"],"summary":"Get Performance Data","description":"Get user's performance metrics.","operationId":"get_performance_data_api_v1_visualization_dashboard_performance_metrics_get","security":[{"OAuth2PasswordBearer":["user"]}],"parameters":[{"name":"discipline","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/ClimbingDiscipline"},{"type":"null"}],"title":"Discipline"}},{"name":"time_range","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Time Range"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardPerformanceMetrics"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/visualization/performance-pyramid":{"get":{"tags":["visualization"],"summary":"Get Performance Pyramid","description":"Get user's performance pyramid for a specific discipline.","operationId":"get_performance_pyramid_api_v1_visualization_performance_pyramid_get","security":[{"OAuth2PasswordBearer":["user"]}],"parameters":[{"name":"discipline","in":"query","required":false,"schema":{"$ref":"#/components/schemas/ClimbingDiscipline","default":"sport"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PerformancePyramidData"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/visualization/base-volume":{"get":{"tags":["visualization"],"summary":"Get Base Volume","description":"Get user's base volume analysis.","operationId":"get_base_volume_api_v1_visualization_base_volume_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BaseVolumeData"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/visualization/progression":{"get":{"tags":["visualization"],"summary":"Get Progression","description":"Get user's progression analysis.","operationId":"get_progression_api_v1_visualization_progression_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProgressionData"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/visualization/location-analysis":{"get":{"tags":["visualization"],"summary":"Get Location Analysis","description":"Get user's climbing location analysis.","operationId":"get_location_analysis_api_v1_visualization_location_analysis_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LocationAnalysis"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}},"/api/v1/visualization/performance-characteristics":{"get":{"tags":["visualization"],"summary":"Get Performance Characteristics","description":"Get user's performance characteristics analysis.","operationId":"get_performance_characteristics_api_v1_visualization_performance_characteristics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PerformanceCharacteristics"}}}}},"security":[{"OAuth2PasswordBearer":["user"]}]}}},"components":{"schemas":{"BaseVolumeData":{"properties":{"volume_by_difficulty":{"additionalProperties":{"additionalProperties":{"anyOf":[{"type":"integer"},{"type":"number"}]},"type":"object"},"type":"object","title":"Volume By Difficulty","description":"Volume metrics by difficulty category"}},"type":"object","required":["volume_by_difficulty"],"title":"BaseVolumeData","description":"Schema for climbing volume analysis data."},"BatchTickCreate":{"properties":{"ticks":{"items":{"$ref":"#/components/schemas/TickCreate"},"type":"array","maxItems":1000,"minItems":1,"title":"Ticks","description":"List of ticks to create"}},"type":"object","required":["ticks"],"title":"BatchTickCreate","description":"Schema for batch tick creation."},"Body_login_for_access_token_api_v1_auth_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"password"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_for_access_token_api_v1_auth_token_post"},"Body_premium_chat_endpoint_api_v1_chat_premium_post":{"properties":{"file":{"anyOf":[{"type":"string","format":"binary"},{"type":"null"}],"title":"File"}},"type":"object","title":"Body_premium_chat_endpoint_api_v1_chat_premium_post"},"ClimbingDiscipline":{"type":"string","enum":["tr","boulder","sport","trad","mixed","winter_ice","aid"],"title":"ClimbingDiscipline","description":"Categories of climbing styles and disciplines."},"ContextResponse":{"properties":{"context_version":{"type":"string","title":"Context Version","description":"Version of the context format"},"summary":{"type":"string","title":"Summary","description":"Human-readable context summary"},"profile":{"type":"object","title":"Profile","description":"Climber profile data"},"performance":{"type":"object","title":"Performance","description":"Performance metrics and data"},"trends":{"type":"object","title":"Trends","description":"Trend analysis data"},"relevance":{"type":"object","title":"Relevance","description":"Relevance scores for context sections"},"goals":{"type":"object","title":"Goals","description":"Climbing goals and progress"},"uploads":{"items":{"type":"object"},"type":"array","title":"Uploads","description":"List of processed uploads"}},"type":"object","required":["context_version","summary","profile","performance","trends","relevance","goals"],"title":"ContextResponse","description":"Response model for context data.","example":{"context_version":"1.0","goals":{"climbing_goals":"Send V8 by December"},"performance":{"highest_boulder_grade":"V5"},"profile":{"total_climbs":200,"years_climbing":3},"relevance":{"training":"goal-driven"},"summary":"You've climbed for 3 years, focusing on bouldering. Your highest send is V5. Goal: V8 by December.","trends":{"grade_progression_6mo":0.8,"grade_progression_all_time":0.5},"uploads":[]}},"ContextUpdatePayload":{"properties":{"updates":{"type":"object","title":"Updates","description":"Dictionary of context sections to update"},"replace":{"type":"boolean","title":"Replace","description":"Replace sections entirely instead of merging","default":false}},"type":"object","required":["updates"],"title":"ContextUpdatePayload","description":"Payload for context updates."},"CruxAngle":{"type":"string","enum":["Slab","Vertical","Overhang","Roof"],"title":"CruxAngle","description":"Wall angle categories for climbing routes."},"CruxEnergyType":{"type":"string","enum":["Power","Power Endurance","Endurance","Technical"],"title":"CruxEnergyType","description":"Energy system categories for crux sequences."},"DashboardBaseMetrics":{"properties":{"recent_ticks":{"items":{"$ref":"#/components/schemas/TickData"},"type":"array","maxItems":50,"title":"Recent Ticks","description":"Recent climbing ticks"},"discipline_stats":{"additionalProperties":{"type":"integer"},"type":"object","title":"Discipline Stats","description":"Distribution of climbs by discipline"},"grade_distribution":{"additionalProperties":{"type":"integer"},"type":"object","title":"Grade Distribution","description":"Distribution of climbs by grade"},"total_climbs":{"type":"integer","minimum":0.0,"title":"Total Climbs","description":"Total number of climbs"}},"type":"object","required":["recent_ticks","discipline_stats","grade_distribution","total_climbs"],"title":"DashboardBaseMetrics","description":"Schema for basic dashboard visualization metrics."},"DashboardPerformanceMetrics":{"properties":{"highest_grades":{"additionalProperties":{"type":"string"},"type":"object","title":"Highest Grades","description":"Highest grades achieved by discipline"},"latest_hard_sends":{"items":{"$ref":"#/components/schemas/HardSend"},"type":"array","maxItems":10,"title":"Latest Hard Sends","description":"Recent hard sends"}},"type":"object","required":["highest_grades","latest_hard_sends"],"title":"DashboardPerformanceMetrics","description":"Schema for performance-focused dashboard metrics."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HardSend":{"properties":{"route_name":{"type":"string","maxLength":200,"minLength":1,"title":"Route Name","description":"Name of the route"},"route_grade":{"type":"string","maxLength":10,"title":"Route Grade","description":"Grade of the route"},"location":{"type":"string","maxLength":200,"title":"Location","description":"Location of the route"},"send_date":{"type":"string","pattern":"^\\d{4}-\\d{2}-\\d{2}$","title":"Send Date","description":"Date of the send"},"discipline":{"type":"string","maxLength":50,"title":"Discipline","description":"Climbing discipline"},"route_url":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Route Url","description":"URL of the route"},"lead_style":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Lead Style","description":"Style of lead"}},"type":"object","required":["route_name","route_grade","location","send_date","discipline"],"title":"HardSend","description":"Schema for significant send achievements."},"LocationAnalysis":{"properties":{"location_distribution":{"additionalProperties":{"additionalProperties":{"anyOf":[{"type":"integer"},{"items":{"type":"string"},"type":"array"}]},"type":"object"},"type":"object","title":"Location Distribution","description":"Distribution of climbs by location"},"seasonal_patterns":{"additionalProperties":{"type":"integer"},"type":"object","title":"Seasonal Patterns","description":"Distribution of climbs by season"}},"type":"object","required":["location_distribution","seasonal_patterns"],"title":"LocationAnalysis","description":"Schema for climbing location analysis data."},"LogbookConnectPayload":{"properties":{"source":{"type":"string","title":"Source","description":"Source of the logbook connection"},"profile_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Profile Url","description":"URL to external profile"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username","description":"External username"},"password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Password","description":"External password"}},"type":"object","required":["source"],"title":"LogbookConnectPayload","description":"Schema for logbook connection payload."},"LogbookType":{"type":"string","enum":["Mountain Project","8a.nu"],"title":"LogbookType","description":"Sources of climbing logbook data."},"PasswordReset":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Email for password reset"},"client_ip":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Ip","description":"Client IP for rate limiting"}},"type":"object","required":["email"],"title":"PasswordReset","description":"Schema for password reset request with rate limiting."},"PasswordUpdate":{"properties":{"token":{"type":"string","minLength":1,"title":"Token","description":"Password reset token"},"new_password":{"type":"string","maxLength":72,"minLength":8,"format":"password","title":"New Password","description":"New password","writeOnly":true},"confirm_password":{"type":"string","maxLength":72,"minLength":8,"format":"password","title":"Confirm Password","description":"Confirm new password","writeOnly":true}},"type":"object","required":["token","new_password","confirm_password"],"title":"PasswordUpdate","description":"Schema for password update with validation."},"PaymentStatus":{"type":"string","enum":["active","inactive","pending","cancelled","failed"],"title":"PaymentStatus","description":"Payment status indicators for subscription management."},"PerformanceCharacteristics":{"properties":{"angle_distribution":{"additionalProperties":{"type":"integer"},"propertyNames":{"$ref":"#/components/schemas/CruxAngle"},"type":"object","title":"Angle Distribution","description":"Distribution of climbs by angle"},"energy_distribution":{"additionalProperties":{"type":"integer"},"propertyNames":{"$ref":"#/components/schemas/CruxEnergyType"},"type":"object","title":"Energy Distribution","description":"Distribution of climbs by energy type"},"attempts_analysis":{"additionalProperties":{"anyOf":[{"type":"integer"},{"type":"number"}]},"type":"object","title":"Attempts Analysis","description":"Analysis of climbing attempts"}},"type":"object","required":["angle_distribution","energy_distribution","attempts_analysis"],"title":"PerformanceCharacteristics","description":"Schema for climbing performance characteristics data."},"PerformanceData":{"properties":{"crux_angle":{"anyOf":[{"$ref":"#/components/schemas/CruxAngle"},{"type":"null"}],"description":"Angle of the crux"},"crux_energy":{"anyOf":[{"$ref":"#/components/schemas/CruxEnergyType"},{"type":"null"}],"description":"Energy type of the crux"},"num_attempts":{"anyOf":[{"type":"integer","maximum":1000.0,"minimum":1.0},{"type":"null"}],"title":"Num Attempts","description":"Number of attempts"},"days_attempts":{"anyOf":[{"type":"integer","maximum":365.0,"minimum":1.0},{"type":"null"}],"title":"Days Attempts","description":"Days spent attempting"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description","description":"Additional notes"},"num_sends":{"anyOf":[{"type":"integer","maximum":1000.0,"minimum":0.0},{"type":"null"}],"title":"Num Sends","description":"Number of successful sends"}},"type":"object","title":"PerformanceData","description":"Schema for detailed performance metrics."},"PerformancePyramidData":{"properties":{"discipline":{"$ref":"#/components/schemas/ClimbingDiscipline","description":"Climbing discipline"},"grade_counts":{"additionalProperties":{"type":"integer"},"type":"object","title":"Grade Counts","description":"Number of sends at each grade"},"total_sends":{"type":"integer","minimum":0.0,"title":"Total Sends","description":"Total number of sends"}},"type":"object","required":["discipline","grade_counts","total_sends"],"title":"PerformancePyramidData","description":"Schema for grade pyramid visualization data."},"PricingInfo":{"properties":{"tier":{"$ref":"#/components/schemas/UserTier","description":"Subscription tier"},"price_id":{"type":"string","maxLength":100,"minLength":1,"title":"Price Id","description":"Stripe price ID"},"price":{"type":"string","pattern":"^\\$\\d+(\\.\\d{2})?$","title":"Price","description":"Price in USD","examples":["$9.99","$29.99"]},"interval":{"type":"string","pattern":"^(month|year)$","title":"Interval","description":"Billing interval"},"features":{"items":{"type":"string"},"type":"array","maxItems":20,"minItems":1,"title":"Features","description":"List of tier features"},"recommended":{"type":"boolean","title":"Recommended","description":"Whether this is the recommended tier","default":false},"trial_days":{"anyOf":[{"type":"integer","maximum":90.0,"minimum":0.0},{"type":"null"}],"title":"Trial Days","description":"Number of trial days available"}},"type":"object","required":["tier","price_id","price","interval","features"],"title":"PricingInfo","description":"Schema for tier pricing information."},"ProgressionData":{"properties":{"progression_by_discipline":{"additionalProperties":{"items":{"additionalProperties":{"anyOf":[{"type":"string","format":"date"},{"type":"string"}]},"type":"object"},"type":"array"},"propertyNames":{"$ref":"#/components/schemas/ClimbingDiscipline"},"type":"object","title":"Progression By Discipline","description":"Progression data by discipline"}},"type":"object","required":["progression_by_discipline"],"title":"ProgressionData","description":"Schema for climbing progression analysis data."},"PyramidInput":{"properties":{"tick_id":{"type":"integer","minimum":1.0,"title":"Tick Id","description":"ID of the associated tick"},"crux_angle":{"anyOf":[{"$ref":"#/components/schemas/CruxAngle"},{"type":"null"}],"description":"Angle of the crux"},"crux_energy":{"anyOf":[{"$ref":"#/components/schemas/CruxEnergyType"},{"type":"null"}],"description":"Energy type of the crux"},"num_attempts":{"anyOf":[{"type":"integer","maximum":1000.0,"minimum":1.0},{"type":"null"}],"title":"Num Attempts","description":"Number of attempts"},"days_attempts":{"anyOf":[{"type":"integer","maximum":365.0,"minimum":1.0},{"type":"null"}],"title":"Days Attempts","description":"Days spent attempting"},"description":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Description","description":"Additional notes or description"}},"type":"object","required":["tick_id"],"title":"PyramidInput","description":"Schema for manual performance pyramid data input."},"RefreshStatus":{"properties":{"status":{"type":"string","pattern":"^(pending|in_progress|completed|failed)$","title":"Status","description":"Status of the refresh operation"},"message":{"type":"string","maxLength":500,"title":"Message","description":"Status message"},"last_sync":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"title":"Last Sync","description":"Last successful sync date"},"items_processed":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Items Processed","description":"Number of items processed"}},"type":"object","required":["status","message"],"title":"RefreshStatus","description":"Schema for data refresh operation status."},"StripeCheckoutSession":{"properties":{"checkout_session_id":{"type":"string","maxLength":100,"minLength":1,"title":"Checkout Session Id","description":"Stripe checkout session ID"},"checkout_url":{"type":"string","maxLength":2083,"minLength":1,"format":"uri","title":"Checkout Url","description":"Checkout session URL"},"tier":{"$ref":"#/components/schemas/UserTier","description":"Selected subscription tier"},"expires_at":{"type":"string","format":"date-time","title":"Expires At","description":"Session expiration timestamp"}},"type":"object","required":["checkout_session_id","checkout_url","tier","expires_at"],"title":"StripeCheckoutSession","description":"Schema for Stripe checkout session response."},"SubscriptionRequest":{"properties":{"desired_tier":{"$ref":"#/components/schemas/UserTier"}},"type":"object","required":["desired_tier"],"title":"SubscriptionRequest"},"TickCreate":{"properties":{"route_name":{"type":"string","maxLength":200,"minLength":1,"title":"Route Name","description":"Name of the route"},"route_grade":{"type":"string","maxLength":10,"title":"Route Grade","description":"Grade of the route"},"binned_grade":{"anyOf":[{"type":"string","maxLength":10},{"type":"null"}],"title":"Binned Grade","description":"Standardized grade bin"},"binned_code":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Binned Code","description":"Numeric grade code"},"tick_date":{"type":"string","format":"date","title":"Tick Date","description":"Date of the tick"},"location":{"type":"string","maxLength":200,"title":"Location","description":"Location of the route"},"location_raw":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Location Raw","description":"Raw location string"},"discipline":{"$ref":"#/components/schemas/ClimbingDiscipline","description":"Climbing discipline"},"length":{"anyOf":[{"type":"integer","maximum":2000.0,"minimum":0.0},{"type":"null"}],"title":"Length","description":"Length in meters"},"pitches":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":1.0},{"type":"null"}],"title":"Pitches","description":"Number of pitches"},"lead_style":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Lead Style","description":"Style of lead"},"send_bool":{"type":"boolean","title":"Send Bool","description":"Whether the route was sent"},"route_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Route Url","description":"URL of the route"},"notes":{"anyOf":[{"type":"string","maxLength":1000},{"type":"null"}],"title":"Notes","description":"Additional notes"},"route_quality":{"anyOf":[{"type":"number","maximum":5.0,"minimum":0.0},{"type":"null"}],"title":"Route Quality","description":"Route quality rating"},"user_quality":{"anyOf":[{"type":"number","maximum":5.0,"minimum":0.0},{"type":"null"}],"title":"User Quality","description":"User's rating"},"logbook_type":{"$ref":"#/components/schemas/LogbookType","description":"Source of the tick data"},"difficulty_category":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Difficulty Category","description":"Difficulty category"},"length_category":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Length Category","description":"Length category"},"season_category":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Season Category","description":"Season category"},"cur_max_rp_sport":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Cur Max Rp Sport","description":"Current max sport redpoint"},"cur_max_rp_trad":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Cur Max Rp Trad","description":"Current max trad redpoint"},"cur_max_boulder":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Cur Max Boulder","description":"Current max boulder"},"performance_data":{"anyOf":[{"$ref":"#/components/schemas/PerformanceData"},{"type":"null"}],"description":"Performance metrics"}},"type":"object","required":["route_name","route_grade","tick_date","location","discipline","send_bool","logbook_type"],"title":"TickCreate","description":"Schema for creating a new climbing tick."},"TickData":{"properties":{"route_name":{"type":"string","maxLength":200,"minLength":1,"title":"Route Name","description":"Name of the route"},"route_grade":{"type":"string","maxLength":10,"title":"Route Grade","description":"Grade of the route"},"binned_grade":{"anyOf":[{"type":"string","maxLength":10},{"type":"null"}],"title":"Binned Grade","description":"Standardized grade bin"},"binned_code":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":0.0},{"type":"null"}],"title":"Binned Code","description":"Numeric grade code"},"tick_date":{"type":"string","format":"date","title":"Tick Date","description":"Date of the tick"},"location":{"type":"string","maxLength":200,"title":"Location","description":"Location of the route"},"discipline":{"$ref":"#/components/schemas/ClimbingDiscipline","description":"Climbing discipline"},"send_bool":{"type":"boolean","title":"Send Bool","description":"Whether the route was sent"},"route_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Route Url","description":"URL of the route"},"route_quality":{"anyOf":[{"type":"number","maximum":5.0,"minimum":0.0},{"type":"null"}],"title":"Route Quality","description":"Route quality rating"},"logbook_type":{"anyOf":[{"$ref":"#/components/schemas/LogbookType"},{"type":"null"}],"description":"Source of the tick data"},"lead_style":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Lead Style","description":"Style of lead (e.g., flash, onsight)"}},"type":"object","required":["route_name","route_grade","tick_date","location","discipline","send_bool"],"title":"TickData","description":"Schema for individual tick visualization data."},"Token":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"JWT access token"},"token_type":{"type":"string","title":"Token Type","description":"Token type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"Token expiration in seconds"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token","description":"JWT refresh token"}},"type":"object","required":["access_token","expires_in"],"title":"Token","description":"OAuth2 token response."},"TokenIntrospectRequest":{"properties":{"token":{"type":"string","title":"Token","description":"JWT token to introspect"},"token_type_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type Hint","description":"Token type hint (access or refresh)"}},"type":"object","required":["token"],"title":"TokenIntrospectRequest","description":"Request to introspect a token."},"TokenIntrospectResponse":{"properties":{"active":{"type":"boolean","title":"Active","description":"Whether the token is active"},"scope":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scope","description":"Space-separated list of scopes"},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id","description":"Client identifier"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username","description":"Resource owner username"},"token_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type","description":"Type of token"},"exp":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Exp","description":"Expiration timestamp"},"iat":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Iat","description":"Issued at timestamp"},"nbf":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Nbf","description":"Not before timestamp"},"sub":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sub","description":"Subject of the token"},"aud":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Aud","description":"Intended audiences"},"iss":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Iss","description":"Token issuer"},"jti":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Jti","description":"JWT ID"}},"type":"object","required":["active"],"title":"TokenIntrospectResponse","description":"Token introspection response."},"TokenRevokeRequest":{"properties":{"token":{"type":"string","title":"Token","description":"JWT token to revoke"},"token_type_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type Hint","description":"Token type hint (access or refresh)"}},"type":"object","required":["token"],"title":"TokenRevokeRequest","description":"Request to revoke a token."},"UserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Unique email address","examples":["user@example.com"]},"username":{"type":"string","maxLength":50,"minLength":3,"pattern":"^[a-zA-Z0-9_-]+$","title":"Username","description":"Unique username (3-50 chars, alphanumeric with _ and -)","examples":["john_doe","climbing_pro"]},"mountain_project_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mountain Project Url","description":"Mountain Project profile URL","default":"","examples":["https://www.mountainproject.com/user/12345/john-doe"]},"eight_a_nu_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Eight A Nu Url","description":"8a.nu profile URL","default":"","examples":["https://www.8a.nu/user/12345"]},"password":{"type":"string","maxLength":72,"minLength":8,"format":"password","title":"Password","description":"Password must be 8-72 characters with mixed case, numbers, and symbols","writeOnly":true}},"type":"object","required":["email","username","password"],"title":"UserCreate","description":"Schema for user registration with password validation."},"UserProfile":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Unique email address","examples":["user@example.com"]},"username":{"type":"string","maxLength":50,"minLength":3,"pattern":"^[a-zA-Z0-9_-]+$","title":"Username","description":"Unique username (3-50 chars, alphanumeric with _ and -)","examples":["john_doe","climbing_pro"]},"mountain_project_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Mountain Project Url","description":"Mountain Project profile URL","examples":["https://www.mountainproject.com/user/12345/john-doe"]},"eight_a_nu_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Eight A Nu Url","description":"8a.nu profile URL","examples":["https://www.8a.nu/user/12345"]},"id":{"type":"string","format":"uuid4","title":"Id","description":"Unique user identifier"},"tier":{"$ref":"#/components/schemas/UserTier","description":"User subscription tier"},"payment_status":{"$ref":"#/components/schemas/PaymentStatus","description":"Payment status"},"stripe_customer_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stripe Customer Id","description":"Stripe customer ID"},"stripe_subscription_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stripe Subscription Id","description":"Stripe subscription ID"},"stripe_webhook_verified":{"type":"boolean","title":"Stripe Webhook Verified","description":"Whether Stripe webhook is verified","default":false},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Account creation timestamp"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login","description":"Last login timestamp"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether user account is active"},"daily_message_count":{"type":"integer","minimum":0.0,"title":"Daily Message Count","description":"Number of messages sent today","default":0},"last_message_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Message Date","description":"Date of last message sent"},"mountain_project_last_sync":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Mountain Project Last Sync","description":"Last Mountain Project data sync"},"eight_a_nu_last_sync":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Eight A Nu Last Sync","description":"Last 8a.nu data sync"},"last_payment_check":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Payment Check","description":"Last payment verification check"},"login_attempts":{"anyOf":[{"type":"integer","minimum":0.0},{"type":"null"}],"title":"Login Attempts","description":"Failed login attempts","default":0},"last_failed_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Failed Login","description":"Last failed login attempt"},"account_locked_until":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Account Locked Until","description":"Account lock expiration"}},"type":"object","required":["email","username","id","tier","payment_status","created_at","is_active"],"title":"UserProfile","description":"Full user profile with all user data and metadata.\n\nThis schema extends UserBase to include all user-related data,\nincluding subscription status, external service connections,\nand usage metrics."},"UserProfileUpdate":{"properties":{"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email","description":"Updated email address","examples":["user@example.com"]},"username":{"anyOf":[{"type":"string","maxLength":50,"minLength":3,"pattern":"^[a-zA-Z0-9_-]+$"},{"type":"null"}],"title":"Username","description":"Updated username (3-50 chars, alphanumeric with _ and -)","examples":["john_doe","climbing_pro"]},"mountain_project_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Mountain Project Url","description":"Updated Mountain Project URL","examples":["https://www.mountainproject.com/user/12345/john-doe"]},"eight_a_nu_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Eight A Nu Url","description":"Updated 8a.nu URL","examples":["https://www.8a.nu/user/12345"]}},"type":"object","title":"UserProfileUpdate","description":"Schema for updating user profile with validation.\n\nOnly allows updating specific fields with appropriate validation\nfor each field."},"UserResponse":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Unique email address","examples":["user@example.com"]},"username":{"type":"string","maxLength":50,"minLength":3,"pattern":"^[a-zA-Z0-9_-]+$","title":"Username","description":"Unique username (3-50 chars, alphanumeric with _ and -)","examples":["john_doe","climbing_pro"]},"mountain_project_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mountain Project Url","description":"Mountain Project profile URL","default":"","examples":["https://www.mountainproject.com/user/12345/john-doe"]},"eight_a_nu_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Eight A Nu Url","description":"8a.nu profile URL","default":"","examples":["https://www.8a.nu/user/12345"]},"id":{"type":"string","format":"uuid4","title":"Id","description":"Unique user identifier"},"tier":{"$ref":"#/components/schemas/UserTier","description":"User subscription tier"},"payment_status":{"$ref":"#/components/schemas/PaymentStatus","description":"Payment status"},"stripe_customer_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stripe Customer Id","description":"Stripe customer ID"},"stripe_subscription_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stripe Subscription Id","description":"Stripe subscription ID"},"stripe_webhook_verified":{"type":"boolean","title":"Stripe Webhook Verified","description":"Whether Stripe webhook is verified","default":false},"daily_message_count":{"type":"integer","title":"Daily Message Count","description":"Daily message count","default":0},"last_message_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Message Date","description":"Last message timestamp"},"mountain_project_last_sync":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Mountain Project Last Sync","description":"Last Mountain Project sync"},"eight_a_nu_last_sync":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Eight A Nu Last Sync","description":"Last 8a.nu sync"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Account creation timestamp"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login","description":"Last login timestamp"},"is_active":{"type":"boolean","title":"Is Active","description":"Whether user account is active"},"last_payment_check":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Payment Check","description":"Last payment check timestamp"},"login_attempts":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Login Attempts","description":"Failed login attempts","default":0},"last_failed_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Failed Login","description":"Last failed login attempt"},"account_locked_until":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Account Locked Until","description":"Account lock expiration"}},"type":"object","required":["email","username","id","tier","payment_status","created_at","is_active"],"title":"UserResponse","description":"Schema for user response data with detailed metadata."},"UserTier":{"type":"string","enum":["free","basic","premium","admin"],"title":"UserTier","description":"User subscription tiers with access levels."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{"user":"Basic user access","basic_user":"Basic tier access","premium_user":"Premium tier access","admin":"Admin access"},"tokenUrl":"/api/v1/auth/token"}}}}}}